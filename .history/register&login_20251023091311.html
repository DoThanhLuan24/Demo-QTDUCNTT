<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>H·ªá th·ªëng Sinh vi√™n</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Segoe UI", sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 2rem 1rem;
            }

            .container {
                max-width: 800px;
                margin: 0 auto;
            }

            .card {
                background: white;
                padding: 2.5rem;
                border-radius: 20px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            }

            .header {
                text-align: center;
                margin-bottom: 2rem;
            }

            .logo {
                font-size: 3rem;
                margin-bottom: 0.5rem;
            }

            .title {
                font-size: 1.75rem;
                color: #333;
                margin-bottom: 0.5rem;
            }

            .subtitle {
                color: #666;
                font-size: 0.9rem;
            }

            .mode-toggle {
                display: flex;
                gap: 1rem;
                margin-bottom: 2rem;
                background: #f8f9fa;
                padding: 0.5rem;
                border-radius: 10px;
            }

            .mode-btn {
                flex: 1;
                padding: 0.75rem;
                border: none;
                border-radius: 8px;
                background: transparent;
                cursor: pointer;
                font-weight: 600;
                transition: all 0.3s;
            }

            .mode-btn.active {
                background: white;
                color: #667eea;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }

            .form-view {
                display: none;
            }

            .form-view.active {
                display: block;
            }

            .form-group {
                margin-bottom: 1.25rem;
            }

            .form-label {
                display: block;
                margin-bottom: 0.5rem;
                color: #555;
                font-weight: 600;
                font-size: 0.875rem;
            }

            .form-label--required::after {
                content: "*";
                color: #f56565;
                margin-left: 0.25rem;
            }

            .form-input {
                width: 100%;
                padding: 0.875rem;
                border: 2px solid #e1e5f2;
                border-radius: 10px;
                font-size: 0.9rem;
                transition: all 0.3s;
            }

            .form-input:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            }

            .form-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 1.25rem;
            }

            .btn {
                width: 100%;
                padding: 0.875rem;
                border: none;
                border-radius: 10px;
                font-size: 1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
            }

            .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
            }

            .alert {
                padding: 0.875rem;
                border-radius: 8px;
                margin-bottom: 1rem;
                display: none;
            }

            .alert--error {
                background: #fee;
                color: #c53030;
                border: 1px solid #feb2b2;
            }

            .alert--success {
                background: #d1fae5;
                color: #065f46;
                border: 1px solid #9ae6b4;
            }

            .demo-accounts {
                background: #f8f9ff;
                border: 2px solid #e1e5f2;
                border-radius: 10px;
                padding: 1rem;
                margin-top: 1.5rem;
                font-size: 0.875rem;
            }

            .demo-title {
                font-weight: 600;
                color: #667eea;
                margin-bottom: 0.75rem;
                text-align: center;
            }

            .demo-item {
                display: flex;
                justify-content: space-between;
                padding: 0.5rem;
                background: white;
                border-radius: 6px;
                margin-bottom: 0.5rem;
                font-size: 0.8rem;
            }

            .social-login {
                margin-bottom: 1.5rem;
            }

            .social-btn {
                width: 100%;
                padding: 0.875rem;
                border: 2px solid #e1e5f2;
                border-radius: 10px;
                background: white;
                cursor: pointer;
                font-size: 0.9rem;
                font-weight: 600;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 0.75rem;
                transition: all 0.3s;
                margin-bottom: 0.75rem;
            }

            .social-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            }

            .social-btn--google:hover {
                border-color: #4285f4;
                background: #f8f9ff;
            }

            .social-btn--microsoft:hover {
                border-color: #00a4ef;
                background: #f0f9ff;
            }

            .social-icon {
                width: 20px;
                height: 20px;
            }

            .divider {
                display: flex;
                align-items: center;
                margin: 1.5rem 0;
                color: #999;
                font-size: 0.875rem;
            }

            .divider::before,
            .divider::after {
                content: "";
                flex: 1;
                height: 1px;
                background: #e1e5f2;
            }

            .divider::before {
                margin-right: 1rem;
            }

            .divider::after {
                margin-left: 1rem;
            }

            .success-view {
                display: none;
                text-align: center;
                padding: 2rem;
            }

            .success-view.active {
                display: block;
            }

            .success-icon {
                font-size: 4rem;
                margin-bottom: 1rem;
            }

            .success-info {
                background: #f8f9fa;
                padding: 1.5rem;
                border-radius: 10px;
                margin: 1.5rem 0;
                text-align: left;
            }

            .info-item {
                display: flex;
                justify-content: space-between;
                margin-bottom: 0.75rem;
            }

            @media (max-width: 768px) {
                .form-grid {
                    grid-template-columns: 1fr;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="card">
                <div class="header">
                    <div class="logo">üéì</div>
                    <h1 class="title" id="mainTitle">H·ªá th·ªëng Sinh vi√™n</h1>
                    <p class="subtitle" id="mainSubtitle">
                        Ch·ªçn ch·ª©c nƒÉng b√™n d∆∞·ªõi
                    </p>
                </div>

                <div class="mode-toggle">
                    <button
                        class="mode-btn active"
                        onclick="switchMode('login')"
                    >
                        ƒêƒÉng nh·∫≠p
                    </button>
                    <button class="mode-btn" onclick="switchMode('register')">
                        ƒêƒÉng k√Ω
                    </button>
                </div>

                <div id="alertBox" class="alert"></div>

                <!-- Login Form -->
                <div class="form-view active" id="loginView">
                    <div class="social-login">
                        <button
                            class="social-btn social-btn--google"
                            onclick="loginWithGoogle()"
                        >
                            <svg class="social-icon" viewBox="0 0 24 24">
                                <path
                                    fill="#4285F4"
                                    d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                                />
                                <path
                                    fill="#34A853"
                                    d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                                />
                                <path
                                    fill="#FBBC05"
                                    d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                                />
                                <path
                                    fill="#EA4335"
                                    d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                                />
                            </svg>
                            ƒêƒÉng nh·∫≠p v·ªõi Google
                        </button>

                        <button
                            class="social-btn social-btn--microsoft"
                            onclick="loginWithMicrosoft()"
                        >
                            <svg class="social-icon" viewBox="0 0 24 24">
                                <path fill="#f25022" d="M1 1h10v10H1z" />
                                <path fill="#00a4ef" d="M13 1h10v10H13z" />
                                <path fill="#7fba00" d="M1 13h10v10H1z" />
                                <path fill="#ffb900" d="M13 13h10v10H13z" />
                            </svg>
                            ƒêƒÉng nh·∫≠p v·ªõi Microsoft
                        </button>
                    </div>

                    <div class="divider">ho·∫∑c ƒëƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n</div>

                    <form id="loginForm">
                        <div class="form-group">
                            <label class="form-label">T√™n ƒëƒÉng nh·∫≠p</label>
                            <input
                                class="form-input"
                                type="text"
                                id="loginUsername"
                                required
                                placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p ho·∫∑c m√£ SV"
                            />
                        </div>
                        <div class="form-group">
                            <label class="form-label">M·∫≠t kh·∫©u</label>
                            <input
                                class="form-input"
                                type="password"
                                id="loginPassword"
                                required
                                placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
                            />
                        </div>
                        <button class="btn btn-primary" type="submit">
                            ƒêƒÉng nh·∫≠p
                        </button>
                    </form>

                    <div class="demo-accounts">
                        <div class="demo-title">üìù T√†i kho·∫£n demo</div>
                        <div class="demo-item">
                            <span><strong>Admin:</strong></span>
                            <span>admin / admin123</span>
                        </div>
                        <div class="demo-item">
                            <span><strong>Sinh vi√™n:</strong></span>
                            <span>student / student123</span>
                        </div>
                    </div>
                </div>

                <!-- Register Form -->
                <div class="form-view" id="registerView">
                    <form id="registerForm">
                        <h3 style="margin-bottom: 1.5rem; color: #667eea">
                            Th√¥ng tin c∆° b·∫£n
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label form-label--required"
                                    >H·ªç v√† t√™n</label
                                >
                                <input
                                    class="form-input"
                                    type="text"
                                    id="fullName"
                                    required
                                    oninvalid="this.setCustomValidity('Vui l√≤ng nh·∫≠p h·ªç v√† t√™n!')"
                                    oninput="this.setCustomValidity('')"
                                />
                            </div>
                            <div class="form-group">
                                <label class="form-label form-label--required"
                                    >Ng√†y sinh</label
                                >
                                <input
                                    class="form-input"
                                    type="date"
                                    id="birthDate"
                                    required
                                    oninvalid="this.setCustomValidity('Vui l√≤ng nh·∫≠p ng√†y sinh!')"
                                    oninput="this.setCustomValidity('')"
                                />
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label form-label--required"
                                    >Email</label
                                >
                                <input
                                    class="form-input"
                                    type="email"
                                    id="email"
                                    required
                                    oninvalid="this.setCustomValidity('Vui l√≤ng nh·∫≠p email!')"
                                    oninput="this.setCustomValidity('')"
                                />
                            </div>
                            <div class="form-group">
                                <label class="form-label form-label--required"
                                    >S·ªë ƒëi·ªán tho·∫°i</label
                                >
                                <input
                                    class="form-input"
                                    type="tel"
                                    id="phone"
                                    required
                                    oninvalid="this.setCustomValidity('Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i!')"
                                    oninput="this.setCustomValidity('')"
                                />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label form-label--required"
                                >ƒêi·ªÉm THPT (0-10)</label
                            >
                            <input
                                class="form-input"
                                type="number"
                                id="highSchoolScore"
                                min="0"
                                max="10"
                                step="0.1"
                                required
                                placeholder="Nh·∫≠p ƒëi·ªÉm trung b√¨nh THPT"
                                oninvalid="this.setCustomValidity('Vui l√≤ng nh·∫≠p ƒëi·ªÉm THPT!')"
                                oninput="this.setCustomValidity('')"
                            />
                        </div>

                        <h3 style="margin: 1.5rem 0; color: #667eea">
                            T√†i kho·∫£n
                        </h3>
                        <div class="form-group">
                            <label class="form-label form-label--required"
                                >T√™n ƒëƒÉng nh·∫≠p</label
                            >
                            <input
                                class="form-input"
                                type="text"
                                id="regUsername"
                                required
                            />
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label form-label--required"
                                    >M·∫≠t kh·∫©u (t·ªëi thi·ªÉu 6 k√Ω t·ª±)</label
                                >
                                <input
                                    class="form-input"
                                    type="password"
                                    id="regPassword"
                                    required
                                />
                            </div>
                            <div class="form-group">
                                <label class="form-label form-label--required"
                                    >X√°c nh·∫≠n m·∫≠t kh·∫©u</label
                                >
                                <input
                                    class="form-input"
                                    type="password"
                                    id="confirmPassword"
                                    required
                                />
                            </div>
                        </div>

                        <button class="btn btn-primary" type="submit">
                            ƒêƒÉng k√Ω
                        </button>
                    </form>
                </div>

                <!-- Success View -->
                <div class="success-view" id="successView">
                    <div class="success-icon">‚úÖ</div>
                    <h2>ƒêƒÉng k√Ω th√†nh c√¥ng!</h2>
                    <p style="color: #666; margin: 1rem 0">
                        T√†i kho·∫£n c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c t·∫°o
                    </p>

                    <div class="success-info">
                        <div class="info-item">
                            <span style="color: #666; font-weight: 600"
                                >M√£ sinh vi√™n:</span
                            >
                            <span id="displayStudentId"></span>
                        </div>
                        <div class="info-item">
                            <span style="color: #666; font-weight: 600"
                                >T√™n ƒëƒÉng nh·∫≠p:</span
                            >
                            <span id="displayUsername"></span>
                        </div>
                        <div class="info-item">
                            <span style="color: #666; font-weight: 600"
                                >Email:</span
                            >
                            <span id="displayEmail"></span>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="goToLogin()">
                        ƒêƒÉng nh·∫≠p ngay
                    </button>
                </div>
            </div>
        </div>

        <script>
            const systemAccounts = [
                {
                    id: 1,
                    name: "Admin User",
                    email: "admin@school.com",
                    role: "admin",
                    username: "admin",
                    password: "admin123",
                },
                {
                    id: 2,
                    name: "Nguy·ªÖn VƒÉn A",
                    email: "student@example.com",
                    role: "student",
                    username: "student",
                    password: "student123",
                    studentId: "SV001",
                    highSchoolScore: 7.5,
                },
            ];

            function switchMode(mode) {
                document
                    .querySelectorAll(".mode-btn")
                    .forEach((btn) => btn.classList.remove("active"));
                event.target.classList.add("active");

                document
                    .querySelectorAll(".form-view")
                    .forEach((view) => view.classList.remove("active"));

                if (mode === "login") {
                    document
                        .getElementById("loginView")
                        .classList.add("active");
                    document.getElementById("mainTitle").textContent =
                        "ƒêƒÉng nh·∫≠p";
                    document.getElementById("mainSubtitle").textContent =
                        "Nh·∫≠p th√¥ng tin t√†i kho·∫£n";
                } else {
                    document
                        .getElementById("registerView")
                        .classList.add("active");
                    document.getElementById("mainTitle").textContent =
                        "ƒêƒÉng k√Ω m·ªõi";
                    document.getElementById("mainSubtitle").textContent =
                        "T·∫°o t√†i kho·∫£n sinh vi√™n";
                }
            }

            function showAlert(message, type = "error") {
                const alertBox = document.getElementById("alertBox");
                alertBox.textContent = message;
                alertBox.className = `alert alert--${type}`;
                alertBox.style.display = "block";

                setTimeout(() => {
                    alertBox.style.display = "none";
                }, 5000);
            }

            function getAllUsers() {
                const registeredStudents = JSON.parse(
                    localStorage.getItem("students") || "[]"
                );

                // Th√™m t√†i kho·∫£n sinh vi√™n demo v√†o localStorage n·∫øu ch∆∞a c√≥
                const demoStudent = {
                    id: 2,
                    studentId: "SV001",
                    fullName: "Nguy·ªÖn VƒÉn A",
                    birthDate: "2000-01-01",
                    email: "student@example.com",
                    phone: "0123456789",
                    highSchoolScore: 7.5,
                    username: "student",
                    password: "student123",
                    role: "student",
                    createdAt: new Date().toISOString(),
                };

                const hasDemoStudent = registeredStudents.some(
                    (s) => s.studentId === "SV001"
                );
                if (!hasDemoStudent) {
                    registeredStudents.push(demoStudent);
                    localStorage.setItem(
                        "students",
                        JSON.stringify(registeredStudents)
                    );
                }

                const studentAccounts = registeredStudents.map((student) => ({
                    id: student.id,
                    name: student.fullName,
                    email: student.email,
                    role: "student",
                    username: student.username,
                    password: student.password,
                    studentId: student.studentId,
                }));

                return [...systemAccounts, ...studentAccounts];
            }

            document
                .getElementById("loginForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();

                    const username = document
                        .getElementById("loginUsername")
                        .value.trim();
                    const password = document
                        .getElementById("loginPassword")
                        .value.trim();

                    if (!username || !password) {
                        showAlert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
                        return;
                    }

                    const allUsers = getAllUsers();
                    const user = allUsers.find(
                        (u) =>
                            (u.username === username ||
                                u.studentId === username) &&
                            u.password === password
                    );

                    if (user) {
                        localStorage.setItem(
                            "currentUser",
                            JSON.stringify(user)
                        );
                        showAlert(`Ch√†o m·ª´ng ${user.name}!`, "success");

                        setTimeout(() => {
                            if (user.role === "admin") {
                                window.location.href = "admin.html";
                            } else {
                                window.location.href = "student.html";
                            }
                        }, 1000);
                    } else {
                        showAlert("T√™n ƒëƒÉng nh·∫≠p ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!");
                    }
                });

            function loginWithGoogle() {
                showAlert("ƒêang k·∫øt n·ªëi v·ªõi Google...", "success");

                setTimeout(() => {
                    const googleUser = {
                        id: Date.now(),
                        name: "Google User",
                        email: "user@gmail.com",
                        role: "student",
                        username: "google_" + Date.now(),
                        provider: "google",
                        studentId: "SV" + Date.now().toString().slice(-6),
                    };

                    localStorage.setItem(
                        "currentUser",
                        JSON.stringify(googleUser)
                    );
                    showAlert(`ƒêƒÉng nh·∫≠p th√†nh c√¥ng v·ªõi Google!`, "success");

                    setTimeout(() => {
                        window.location.href = "student.html";
                    }, 1000);
                }, 1500);
            }

            function loginWithMicrosoft() {
                showAlert("ƒêang k·∫øt n·ªëi v·ªõi Microsoft...", "success");

                setTimeout(() => {
                    const msUser = {
                        id: Date.now(),
                        name: "Microsoft User",
                        email: "user@outlook.com",
                        role: "student",
                        username: "ms_" + Date.now(),
                        provider: "microsoft",
                        studentId: "SV" + Date.now().toString().slice(-6),
                    };

                    localStorage.setItem("currentUser", JSON.stringify(msUser));
                    showAlert(`ƒêƒÉng nh·∫≠p th√†nh c√¥ng v·ªõi Microsoft!`, "success");

                    setTimeout(() => {
                        window.location.href = "student.html";
                    }, 1000);
                }, 1500);
            }

            document
                .getElementById("registerForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();

                    const fullName = document
                        .getElementById("fullName")
                        .value.trim();
                    const birthDate =
                        document.getElementById("birthDate").value;
                    const email = document.getElementById("email").value.trim();
                    const phone = document.getElementById("phone").value.trim();
                    const highSchoolScore = parseFloat(
                        document.getElementById("highSchoolScore").value
                    );
                    const username = document
                        .getElementById("regUsername")
                        .value.trim();
                    const password = document
                        .getElementById("regPassword")
                        .value.trim();
                    const confirmPassword = document
                        .getElementById("confirmPassword")
                        .value.trim();

                    if (
                        !fullName ||
                        !birthDate ||
                        !email ||
                        !phone ||
                        !username ||
                        !password ||
                        !confirmPassword ||
                        isNaN(highSchoolScore)
                    ) {
                        showAlert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!");
                        return;
                    }

                    if (highSchoolScore < 0 || highSchoolScore > 10) {
                        showAlert("ƒêi·ªÉm THPT ph·∫£i t·ª´ 0 ƒë·∫øn 10!");
                        return;
                    }

                    if (password.length < 6) {
                        showAlert("M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±!");
                        return;
                    }

                    if (password !== confirmPassword) {
                        showAlert("M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp!");
                        return;
                    }

                    if (!email.includes("@")) {
                        showAlert("Email kh√¥ng h·ª£p l·ªá!");
                        return;
                    }

                    const existingUsers = getAllUsers();
                    if (existingUsers.find((u) => u.username === username)) {
                        showAlert("T√™n ƒëƒÉng nh·∫≠p ƒë√£ t·ªìn t·∫°i!");
                        return;
                    }

                    const studentId = "SV" + Date.now().toString().slice(-6);
                    const studentData = {
                        id: Date.now(),
                        studentId: studentId,
                        fullName: fullName,
                        birthDate: birthDate,
                        email: email,
                        phone: phone,
                        highSchoolScore: highSchoolScore,
                        username: username,
                        password: password,
                        role: "student",
                        createdAt: new Date().toISOString(),
                    };

                    const students = JSON.parse(
                        localStorage.getItem("students") || "[]"
                    );
                    students.push(studentData);
                    localStorage.setItem("students", JSON.stringify(students));

                    document.getElementById("displayStudentId").textContent =
                        studentId;
                    document.getElementById("displayUsername").textContent =
                        username;
                    document.getElementById("displayEmail").textContent = email;

                    document
                        .getElementById("registerView")
                        .classList.remove("active");
                    document
                        .getElementById("successView")
                        .classList.add("active");
                    document.querySelector(".mode-toggle").style.display =
                        "none";

                    showAlert("ƒêƒÉng k√Ω th√†nh c√¥ng!", "success");
                });

            function goToLogin() {
                document
                    .getElementById("successView")
                    .classList.remove("active");
                document.getElementById("loginView").classList.add("active");
                document.querySelector(".mode-toggle").style.display = "flex";

                document
                    .querySelectorAll(".mode-btn")
                    .forEach((btn) => btn.classList.remove("active"));
                document
                    .querySelectorAll(".mode-btn")[0]
                    .classList.add("active");

                document.getElementById("mainTitle").textContent = "ƒêƒÉng nh·∫≠p";
                document.getElementById("mainSubtitle").textContent =
                    "S·ª≠ d·ª•ng t√†i kho·∫£n v·ª´a t·∫°o";

                document.getElementById("registerForm").reset();
            }
        </script>
    </body>
</html>
